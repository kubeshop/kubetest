openapi: 3.0.1

info:
  title: TestKube API
  description: "TestKube provides a Kubernetes-native framework for test definition, execution and results"
  contact:
    email: testkube@kubeshop.io
  license:
    name: MIT
    url: https://opensource.org/licenses/MIT
  version: 1.0.0

externalDocs:
  description: "Find out more about testkube"
  url: http://testkube.io

tags:
  - name: api
    description: "TestKube API operations"
  - name: scripts
    description: "Script operations"
  - name: executions
    description: "Execution operations"
  - name: tests
    description: "Scripts orchestration operations"

paths:
  /tests:
    get:
      tags:
        - tests
        - api
      summary: "Get all tests"
      description: "Returns array of tests"
      operationId: listTests
      parameters:
        - $ref: "#/components/parameters/ExecutionsTextSearch"
        - $ref: "#/components/parameters/ExecutionsPageSize"
        - $ref: "#/components/parameters/ExecutionsPageIndex"
        - $ref: "#/components/parameters/ExecutionsStatusFilter"
        - $ref: "#/components/parameters/ExecutionsStartDateFilter"
        - $ref: "#/components/parameters/ExecutionsEndDateFilter"
        - $ref: "#/components/parameters/Tags"
      responses:
        200:
          description: successful operation
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Test"
        500:
          description: "problem with getting script executions from storage"
          content:
            application/problem+json:
              schema:
                type: array
                items:
                  $ref: "#/components/schemas/Problem"

  /tests/{id}:
    get:
      parameters:
        - in: path
          name: id
          schema:
            type: string
          required: true
          description: ID of the test
      tags:
        - tests
        - api
      summary: "Get script execution by ID"
      description: "Returns execution with given executionID"
      operationId: getExecutionByID
      responses:
        200:
          description: successful operation
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Execution"
        500:
          description: "problem with getting test from storage"
          content:
            application/problem+json:
              schema:
                type: array
                items:
                  $ref: "#/components/schemas/Problem"

  /executions:
    get:
      tags:
        - executions
        - api
      summary: "Get all script executions"
      description: "Returns array of scripts executions"
      operationId: listExecutions
      parameters:
        - $ref: "#/components/parameters/ExecutionsTest"
        - $ref: "#/components/parameters/ExecutionsTextSearch"
        - $ref: "#/components/parameters/ExecutionsPageSize"
        - $ref: "#/components/parameters/ExecutionsPageIndex"
        - $ref: "#/components/parameters/ExecutionsStatusFilter"
        - $ref: "#/components/parameters/ExecutionsStartDateFilter"
        - $ref: "#/components/parameters/ExecutionsEndDateFilter"
        - $ref: "#/components/parameters/Tags"
      responses:
        200:
          description: successful operation
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ExecutionsResult"
        500:
          description: "problem with getting script executions from storage"
          content:
            application/problem+json:
              schema:
                type: array
                items:
                  $ref: "#/components/schemas/Problem"

  /executions/{executionID}:
    get:
      parameters:
        - in: path
          name: executionID
          schema:
            type: string
          required: true
          description: ID of the script execution
      tags:
        - executions
        - api
      summary: "Get script execution by ID"
      description: "Returns execution with given executionID"
      operationId: getExecutionByID
      responses:
        200:
          description: successful operation
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Execution"
        500:
          description: "problem with getting script executions from storage"
          content:
            application/problem+json:
              schema:
                type: array
                items:
                  $ref: "#/components/schemas/Problem"

  /executions/{id}/artifacts:
    get:
      parameters:
        - in: path
          name: id
          schema:
            type: string
          required: true
          description: ID of the script execution
      tags:
        - artifacts
        - executions
        - api
      summary: "Get execution's artifacts by ID"
      description: "Returns artifacts of the given executionID"
      operationId: getExecutionArtifacts
      responses:
        200:
          description: successful operation
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: "#/components/schemas/Artifact"
        500:
          description: "problem with getting execution's artifacts from storage"
          content:
            application/problem+json:
              schema:
                type: array
                items:
                  $ref: "#/components/schemas/Problem"

  /executions/{id}/artifacts/{filename}:
    get:
      parameters:
        - in: path
          name: id
          schema:
            type: string
          required: true
          description: ID of the script execution
        - in: path # minio/[bucket_exec_id]/cypress/video/somevideo.avi
          name: filename
          schema:
            type: string
          required: true
          description: name of the file in the bucket
      operationId: downloadFile
      responses:
        200:
          description: successful operation
          content:
            application/octet-stream:
              schema:
                type: string
                format: binary
        500:
          description: "problem with getting artifacts from storage"
          content:
            application/problem+json:
              schema:
                type: array
                items:
                  $ref: "#/components/schemas/Problem"

  /scripts:
    get:
      tags:
        - scripts
        - api
      summary: "List scripts"
      description: "filters will be added later"
      operationId: listScripts
      parameters:
        - $ref: "#/components/parameters/Tags"
      responses:
        200:
          description: "successful operation"
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: "#/components/schemas/Script"
        502:
          description: "problem with read information from kubernetes cluster"
          content:
            application/problem+json:
              schema:
                type: array
                items:
                  $ref: "#/components/schemas/Problem"
    post:
      tags:
        - scripts
        - api
      summary: "create new script"
      description: "create new script based on script content or git based data"
      operationId: createScript
      requestBody:
        description: script details body
        required: true
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/ScriptUpsertRequest"
      responses:
        200:
          description: "successful operation"
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: "#/components/schemas/Script"
        400:
          description: "problem with script definition - probably some bad input occurs (invalid JSON body or similar)"
          content:
            application/problem+json:
              schema:
                type: array
                items:
                  $ref: "#/components/schemas/Problem"
        502:
          description: "problem with communicating with kubernetes cluster"
          content:
            application/problem+json:
              schema:
                type: array
                items:
                  $ref: "#/components/schemas/Problem"
    delete:
      tags:
        - scripts
        - api
      summary: "delete scripts"
      description: "deletes all the scripts"
      operationId: deleteScripts
      responses:
        204:
          description: "no content"
        502:
          description: "problem with read information from kubernetes cluster"
          content:
            application/problem+json:
              schema:
                type: array
                items:
                  $ref: "#/components/schemas/Problem"

  /scripts/{id}:
    patch:
      tags:
        - scripts
        - api
      summary: "update script"
      description: "update script based on script content or git based data"
      operationId: updateScript
      requestBody:
        description: script details body
        required: true
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/ScriptUpsertRequest"
      responses:
        200:
          description: "successful operation"
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: "#/components/schemas/Script"
        400:
          description: "problem with script definition - probably some bad input occurs (invalid JSON body or similar)"
          content:
            application/problem+json:
              schema:
                type: array
                items:
                  $ref: "#/components/schemas/Problem"
        502:
          description: "problem with communicating with kubernetes cluster"
          content:
            application/problem+json:
              schema:
                type: array
                items:
                  $ref: "#/components/schemas/Problem"

    get:
      tags:
        - scripts
        - api
      parameters:
        - in: path
          name: id
          schema:
            type: string
          required: true
          description: ID of the script
      summary: "Get script"
      description: "Gets the specified script"
      operationId: getScript
      responses:
        200:
          description: "successful operation"
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Script"
        502:
          description: "problem with read information from kubernetes cluster"
          content:
            application/problem+json:
              schema:
                type: array
                items:
                  $ref: "#/components/schemas/Problem"
    delete:
      tags:
        - scripts
        - api
      parameters:
        - in: path
          name: id
          schema:
            type: string
          required: true
          description: ID of the script
      summary: "delete script"
      description: "deletes a script"
      operationId: deleteScript
      responses:
        204:
          description: "no content"
        502:
          description: "problem with read information from kubernetes cluster"
          content:
            application/problem+json:
              schema:
                type: array
                items:
                  $ref: "#/components/schemas/Problem"

  /scripts/{id}/executions:
    post:
      parameters:
        - in: path
          name: id
          schema:
            type: string
          required: true
          description: ID of the script
        - in: query
          name: namespace
          schema:
            type: integer
          description: kubernetes namespace
          required: false
        - $ref: "#/components/parameters/Tags"
      tags:
        - api
        - scripts
        - executions
      summary: "Starts new script execution"
      description: "New script execution returns new execution details on successful execution start"
      operationId: executeScript
      requestBody:
        description: body passed to configure execution
        required: true
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/ExecutionRequest"
      responses:
        201:
          description: successful operation
          content:
            application/json:
              schema:
                type: object
                items:
                  $ref: "#/components/schemas/ExecutionResult"
        400:
          description: "problem with request body"
          content:
            application/problem+json:
              schema:
                type: array
                items:
                  $ref: "#/components/schemas/Problem"
        502:
          description: "problem with communicating with kubernetes cluster"
          content:
            application/problem+json:
              schema:
                type: array
                items:
                  $ref: "#/components/schemas/Problem"
        500:
          description: "problem with script execution"
          content:
            application/problem+json:
              schema:
                type: array
                items:
                  $ref: "#/components/schemas/Problem"

    get:
      parameters:
        - in: path
          name: id
          schema:
            type: string
          required: true
          description: ID of the script
        - $ref: "#/components/parameters/ExecutionsPageSize"
        - $ref: "#/components/parameters/ExecutionsPageIndex"
        - $ref: "#/components/parameters/ExecutionsStatusFilter"
        - $ref: "#/components/parameters/ExecutionsStartDateFilter"
        - $ref: "#/components/parameters/ExecutionsEndDateFilter"
      tags:
        - api
        - scripts
        - executions
      summary: "Get all script executions"
      description: "Returns array of all available script executions"
      operationId: listExecutions
      responses:
        200:
          description: successful operation
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ExecutionsResult"
        500:
          description: "problem with getting script executions from storage"
          content:
            application/problem+json:
              schema:
                type: array
                items:
                  $ref: "#/components/schemas/Problem"

  /scripts/{id}/executions/{executionID}:
    get:
      parameters:
        - in: path
          name: id
          schema:
            type: string
          required: true
          description: ID of the script
        - in: path
          name: executionID
          schema:
            type: string
          required: true
          description: ID of the script execution
      tags:
        - api
        - scripts
        - executions
      summary: "Get script execution"
      description: "Returns execution with given executionID"
      operationId: getExecution
      responses:
        200:
          description: successful operation
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Execution"
        500:
          description: "problem with getting script executions from storage"
          content:
            application/problem+json:
              schema:
                type: array
                items:
                  $ref: "#/components/schemas/Problem"
    delete:
      parameters:
        - in: path
          name: id
          schema:
            type: string
          required: true
          description: ID of the script
        - in: path
          name: executionID
          schema:
            type: string
          required: true
          description: ID of the script execution
      tags:
        - api
        - scripts
        - executions
      summary: "Aborts execution"
      description: "Aborts execution and returns execution details"
      operationId: abortExecution
      responses:
        501:
          description: not implemented yet
          content:
            application/json:
              schema:
                type: object
                items:
                  $ref: "#/components/schemas/ExecutionResult"

  /executors:
    get:
      tags:
        - executor
        - api
      summary: "List executors"
      description: "List executors available in cluster"
      operationId: listExecutors
      parameters:
        - in: query
          name: namespace
          schema:
            type: integer
          description: kubernetes namespace
          required: false
      responses:
        200:
          description: "successful operation"
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: "#/components/schemas/Executor"
        502:
          description: "problem with read information from kubernetes cluster"
          content:
            application/problem+json:
              schema:
                type: array
                items:
                  $ref: "#/components/schemas/Problem"
    post:
      tags:
        - scripts
        - api
      summary: "create new executor"
      description: "create new executor based on params passed in request"
      operationId: createExecutor
      requestBody:
        description: executor request body data
        required: true
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/ExecutorCreateRequest"
      responses:
        200:
          description: "successful operation"
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: "#/components/schemas/ExecutorDetails"
        400:
          description: "problem with executor definition - probably some bad input occurs (invalid JSON body or similar)"
          content:
            application/problem+json:
              schema:
                type: array
                items:
                  $ref: "#/components/schemas/Problem"
        502:
          description: "problem with communicating with kubernetes cluster"
          content:
            application/problem+json:
              schema:
                type: array
                items:
                  $ref: "#/components/schemas/Problem"

  /executors/{name}:
    delete:
      parameters:
        - in: path
          name: name
          schema:
            type: string
          required: true
          description: Executor CRD name
        - in: query
          name: namespace
          schema:
            type: string
          required: true
          description: CRD namespace
      tags:
        - api
        - executor
      summary: "Delete executor"
      description: "Deletes executor by its name"
      operationId: deleteExecutor
      responses:
        204:
          description: executor deleted successfuly
        502:
          description: "problem with communicating with kubernetes cluster"
          content:
            application/problem+json:
              schema:
                type: array
                items:
                  $ref: "#/components/schemas/Problem"

    get:
      parameters:
        - in: path
          name: name
          schema:
            type: string
          required: true
          description: Executor CRD name
        - in: query
          name: namespace
          schema:
            type: integer
          description: kubernetes namespace
          required: false
      tags:
        - api
        - executor
      summary: "Get executor details"
      description: "Returns executors data with executions passed to executor"
      operationId: getExecutor
      responses:
        200:
          description: successful operation
          content:
            application/json:
              schema:
                type: object
                items:
                  $ref: "#/components/schemas/ExecutorDetails"
        502:
          description: "problem with communicating with kubernetes cluster"
          content:
            application/problem+json:
              schema:
                type: array
                items:
                  $ref: "#/components/schemas/Problem"
        500:
          description: "problem with getting executor data"
          content:
            application/problem+json:
              schema:
                type: array
                items:
                  $ref: "#/components/schemas/Problem"

components:
  schemas:
    ObjectRef:
      required:
        - name
      type: object
      properties:
        namespace:
          type: string
          description: object kubernetes namespace
        name:
          type: string
          description: object name

    Test:
      type: object
      required:
        - name
        - status
        - steps
      properties:
        name:
          type: string
        description:
          type: string
        before:
          type: array
          items:
            $ref: "#/components/schemas/TestStep"
          description: Run this step before whole suite
        tags:
          type: array
          items:
            type: string
          description: test tags
        steps:
          type: array
          items:
            $ref: "#/components/schemas/TestStep"
          description: Steps to run
        after:
          type: array
          items:
            $ref: "#/components/schemas/TestStep"
          description: Run this step after whole suite
        repeats:
          type: integer
          default: 1

    TestStepType:
      type: string
      enum:
        - executeScript
        - delay

    TestStep: 
      type: object 
      required:
        - name
      properties:
        name:
          type: string
          description: step name (in case of script it'll be script name)
        stopTestOnFailure:
          type: boolean
          default: true

    TestStepExecuteScript: 
      allOf:
        - $ref: '#/components/schemas/TestStep'
        - $ref: "#/components/schemas/ObjectRef"

    TestStepDelay: 
      allOf:
        - $ref: '#/components/schemas/TestStep'
        - type: object
          required:
            - duration
          properties:
            duration:
              type: integer
              default: 0
              description: delay duration in milliseconds

    TestExecution:
      type: object
      description: API server test scripts executions container
      properties:
        id:
          type: string
          description: execution id
          format: bson objectId
        name:
          type: string
          description: "execution name"
        status:
          $ref: '#/components/schemas/TestStatus'
        envs:
          type: object
          description: "environment variables passed to executor"
          additionalProperties:
            type: string
          example:
            record: "true"
            prefix: "some-"
        params:
          type: object
          description: "execution params passed to executor converted to vars for usage in tests"
          additionalProperties:
            type: string
          example:
            users: "3"
            prefix: "some-"
        startTime:
          type: string
          description: "test start time"
          format: date-time
        endTime:
          type: string
          description: "test end time"
          format: date-time
        stepResults:
          type: array
          description: "steps execution restults"
          items:
            $ref: "#/components/schemas/TestStepExecutionResult"
            description: test execution results
        tags:
          type: array
          items:
            type: string
          description: test execution tags
          
    TestStatus:
      type: string
      enum:
        - queued
        - pending
        - success
        - error

    TestStepExecutionResult:
      description: execution result returned from executor
      type: object
      required:
        - status
      properties:
        script:
          $ref: "#/components/schemas/ObjectRef"
          description: name and namespace of script in object reference
        execution: 
          $ref: "#/components/schemas/Execution"
          description: test step execution

    TestExecutionsResult:
      description: the result for a page of executions
      type: object
      required:
        - totals
        - results
      properties:
        totals:
          $ref: "#/components/schemas/ExecutionsTotals"
        filtered:
          $ref: "#/components/schemas/ExecutionsTotals"
        results:
          type: array
          items:
            $ref: "#/components/schemas/TestExecutionSummary"

    TestExecutionSummary:
      description: test execution summary
      type: object
      required:
        - id
        - name
        - testName
        - status
      properties:
        id:
          type: string
          description: execution id
          format: bson objectId
        name:
          type: string
          description: execution name
        testName:
          type: string
          description: name of the script
        status:
          $ref: "#/components/schemas/TestStatus"
        startTime:
          type: string
          description: "test execution start time"
          format: date-time
        endTime:
          type: string
          description: "test execution end time"
          format: date-time
        executions:
          type: array
          items:
            type: string
          description: list of scripts execution id's

    Script:
      type: object
      properties:
        name:
          type: string
          description: script name
        type:
          type: string
          description: script type
          enum:
            - postman/collection
        content:
          type: string
          description: script content
        created:
          type: string
          format: date-time
        tags:
          type: array
          items:
            type: string
          description: script tags

    Execution:
      type: object
      description: API server script execution
      properties:
        id:
          type: string
          description: execution id
          format: bson objectId
        scriptName:
          type: string
          description: unique script name (CRD Script name)
        scriptType:
          type: string
          description: script type e.g. postman/collection
        name:
          type: string
          description: "execution name"
        envs:
          type: object
          description: "environment variables passed to executor"
          additionalProperties:
            type: string
          example:
            record: "true"
            prefix: "some-"
        args:
          type: array
          description: "additional arguments/flags passed to executor binary"
          example: ["--concurrency", "2", "--remote", "--some", "blabla"]
          items:
            type: string
        params:
          type: object
          description: "execution params passed to executor converted to vars for usage in tests"
          additionalProperties:
            type: string
          example:
            users: "3"
            prefix: "some-"
        scriptContent:
          type: string
          description: script metadata content
        repository:
          $ref: "#/components/schemas/Repository"
        startTime:
          type: string
          description: "test start time"
          format: date-time
        endTime:
          type: string
          description: "test end time"
          format: date-time
        executionResult:
          required: true
          description: result get from executor
          $ref: "#/components/schemas/ExecutionResult"
        tags:
          type: array
          items:
            type: string
          description: test tags

    Artifact:
      type: object
      description: API server artifact
      properties:
        name:
          type: string # https://api-server/exec_id/subdirectory/file_name
          description: artifact file path
        size:
          type: integer
          description: file size in bytes

    ExecutionsResult:
      description: the result for a page of executions
      type: object
      required:
        - totals
        - results
      properties:
        totals:
          $ref: "#/components/schemas/ExecutionsTotals"
        filtered:
          $ref: "#/components/schemas/ExecutionsTotals"
        results:
          type: array
          items:
            $ref: "#/components/schemas/ExecutionSummary"

    ExecutionSummary:
      description: execution summary
      type: object
      required:
        - id
        - name
        - scriptName
        - scriptType
        - status
      properties:
        id:
          type: string
          description: execution id
          format: bson objectId
        name:
          type: string
          description: execution name
        scriptName:
          type: string
          description: name of the script
        scriptType:
          type: string
          description: the type of script for this execution
        status:
          $ref: "#/components/schemas/ExecutionStatus"
        startTime:
          type: string
          description: "test execution start time"
          format: date-time
        endTime:
          type: string
          description: "test execution end time"
          format: date-time

    ExecutionStatus:
      type: string
      enum:
        - queued
        - pending
        - success
        - error

    ExecutionResult:
      description: execution result returned from executor
      type: object
      required:
        - status
      properties:
        status:
          $ref: "#/components/schemas/ExecutionStatus"
        output:
          type: string
          description: "RAW Script execution output, depends of reporter used in particular tool"
        outputType:
          type: string
          description: "output type depends of reporter used in partucular tool"
          enum:
            - text/plain
            - application/junit+xml
            - application/json
        errorMessage:
          type: string
          description: "error message when status is error, separate to output as output can be partial in case of error"
        steps:
          type: array
          items:
            $ref: "#/components/schemas/ExecutionStepResult"
          description: execution steps (for collection of requests)

    ExecutionStepResult:
      description: execution result data
      type: object
      required:
        - name
        - status
      properties:
        name:
          type: string
          description: step name
        duration:
          type: string
          format: duration
        status:
          type: string
          description: execution step status
          enum: [success, error]
        assertionResults:
          type: array
          items:
            $ref: "#/components/schemas/AssertionResult"

    AssertionResult:
      description: execution result data
      type: object
      properties:
        name:
          type: string
        status:
          type: string
          enum: [success, error]
        errorMessage:
          type: string
          nullable: true

    ExecutionsTotals:
      type: object
      description: various execution counters
      required:
        - results
        - passed
        - failed
        - queued
        - pending
      properties:
        results:
          type: integer
          description: the total number of executions available
        passed:
          type: integer
          description: the total number of passed executions available
        failed:
          type: integer
          description: the total number of failed executions available
        queued:
          type: integer
          description: the total number of queued executions available
        pending:
          type: integer
          description: the total number of running executions available

    ServerInfo:
      type: object
      description: Server information with build version, build commit etc.
      required:
        - version
      properties:
        version:
          type: string
          description: build version
        commit:
          type: string
          description: build commit

    #
    # Requests
    #

    ExecutorStartRequest:
      description: scripts execution request body when calling new execution request
      type: object
      properties:
        id:
          type: string
          description: ID of script execution to handle by executor, execution need to be able to return execution info based on this ID
          example: af7f8afa8bc8ab8ab8a83b8
        type:
          type: string
          description: script type
          example: postaman/collection
        name:
          type: string
          description: script execution custom name
          example: testing with 1000 users
        params:
          type: object
          description: "execution params passed to executor"
          additionalProperties:
            type: string
          example:
            users: "3"
            prefix: "some-"
        content:
          type: string
          description: script content as string (content depends from executor)
        inputType:
          type: string
          description: >
            script content type can be: 
            - direct content - created from file,
            - git repository with path, will be checked out, useful when test have more than one file or complicated directory structure,
          enum:
            - content
            - git
        repository:
          $ref: "#/components/schemas/Repository"

    Repository:
      description: repository representation for tests in git repositories
      type: object
      required:
        - type
        - uri
        - branch
      properties:
        type:
          type: string
          enum:
            - git
          description: VCS repository type
        uri:
          type: string
          description: uri of content file or git directory
        branch:
          type: string
          description: branch/tag name for checkout
        path:
          type: string
          description: if needed we can checkout particular path (dir or file) in case of BIG/mono repositories

    ExecutionRequest:
      description: scripts execution request body
      type: object
      properties:
        name:
          type: string
          description: script execution custom name
          example: testing with 1000 users
        namespace:
          type: string
          description: script kubernetes namespace ("testkube" when not set)
          example: testkube
        params:
          type: object
          description: "execution params passed to executor"
          additionalProperties:
            type: string
          example:
            users: "3"
            prefix: "some-"

    TestExecutionRequest:
      description: test execution request body
      type: object
      properties:
        name:
          type: string
          description: script execution custom name
          example: testing with 1000 users
        namespace:
          type: string
          description: script kubernetes namespace ("testkube" when not set)
          example: testkube
        params:
          type: object
          description: "execution params passed to executor"
          additionalProperties:
            type: string
          example:
            users: "3"
            prefix: "some-"

    ScriptUpsertRequest:
      description: scripts create request body
      type: object
      properties:
        name:
          type: string
          description: script name - Custom Resource name - must be unique, use only lowercase numbers and dashes (-)
          example: kubeshop-homepage-test
        type:
          type: string
          description: script type - what executor type should be used during test execution
          example: postman/collection
        namespace:
          type: string
          description: kubernetes namespace (defaults to 'testkube')
          example: testkube
        inputType:
          type: string
          description: >
            script content type can be: 
            - direct content - created from file, 
            - git repo directory checkout in case when test is some kind of project or have more than one file,
          enum:
            - content
            - git
        repository:
          $ref: "#/components/schemas/Repository"
        content:
          type: string
          description: script content - executor specific e.g. fo postman-collections executor
          example: >
            {
              "info": {
                "_postman_id": "57ad6291-5b8f-4b2d-b24d-d2d2ce8785bb",
                "name": "SimpleKubeshop",
                "schema": "https://schema.getpostman.com/json/collection/v2.1.0/collection.json"
              },
              "item": [
                {
                  "name": "Homepage",
                  "request": {
                    "method": "GET",
                    "header": [],
                    "url": null
                  },
                  "response": []
                }

    TestUpsertRequest:
      description: test create request body
      type: object
      required:
        - name
        - namespace
      allOf: 
        - $ref: "#/components/schemas/Test"
        - $ref: "#/components/schemas/ObjectRef"

    ExecutorCreateRequest:
      description: executor create request body
      type: object
      required:
        - name
        - namespace
        - types
      allOf: 
        - $ref: "#/components/schemas/Executor"
        - $ref: "#/components/schemas/ObjectRef"

    # Copied from CRD spec
    # https://github.com/kubeshop/testkube-operator/blob/main/config/crd/bases/executor.kubtest.io_executors.yaml
    # TODO we need to sync those in some nice way
    Executor:
      description: CRD based executor data
      type: object
      properties:
        executorType:
          description:
            ExecutorType one of "rest" for rest openapi based executors
            or "job" which will be default runners for testkube soon
          type: string
        image:
          description: Image for kube-job
          type: string
        types:
          description: Types defines what types can be handled by executor e.g.
            "postman/collection", ":curl/command" etc
          items:
            type: string
          type: array
        uri:
          description: URI for rest based executors
          type: string
        volumeMountPath:
          description: VolumeMountPath - where should PV be monted inside job
            pod for e.g. artifacts
          type: string
        volumeQuantity:
          description: VolumeQuantity for kube-job PersistentVolume
          type: string

    ExecutorDetails:
      description: Executor details with Executor data and additional information like list of executions
      type: object
      properties:
        name:
          description: Executor name
          type: string
        executor:
          $ref: "#/components/schemas/Executor"
        executions:
          $ref: "#/components/schemas/ExecutionsResult"

    ExecutorOutput:
      description: CRD based executor data
      type: object
      required:
        - type
      properties:
        type:
          type: string
          description: One of possible output types
          enum:
            - error
            - log
            - event
            - result
        content:
          type: string
          description: Message/event data passed from executor (like log lines etc)
          example:
        result:
          description: Execution result when job is finished
          $ref: "#/components/schemas/ExecutionResult"

    #
    # Errors
    #

    Problem:
      description: problem response in case of error
      type: object
      properties:
        type:
          type: string
          description: Type contains a URI that identifies the problem type. This URI will,
          example: http://kubeshop.io/testkube/problems/invalidscriptname
        title:
          type: string
          description: Title is a short, human-readable summary of the problem type. This title SHOULD NOT change from occurrence to occurrence of the problem, except forpurposes of localization.
          example: Invalid script name
        status:
          type: integer
          description: HTTP status code for this occurrence of the problem.
          example: 500
        detail:
          type: string
          description: A human-readable explanation specific to this occurrence of the problem.
          example: Your script name can't contain forbidden characters like "}}}" passed
        instance:
          type: string
          description: A URI that identifies the specific occurrence of the problem. This URI may or may not yield further information if de-referenced.
          example: http://10.23.23.123:8088/scripts

  #
  # Parameters
  #

  parameters:
    ExecutionsTest:
      in: query
      name: test
      schema:
        type: string
        default: ""
      description: test namespaced name to filter
      required: false
    ExecutionsTextSearch:
      in: query
      name: textSearch
      schema:
        type: string
        default: ""
      description: text to search in name and script name
      required: false
    ExecutionsPageSize:
      in: query
      name: pageSize
      schema:
        type: integer
        default: 100
      description: the number of executions to get, setting to 0 will return only totals
      required: false
    ExecutionsPageIndex:
      in: query
      name: page
      schema:
        type: integer
        default: 0
      description: the page index to start at
      required: false
    ExecutionsStatusFilter:
      in: query
      name: status
      schema:
        $ref: "#/components/schemas/ExecutionStatus"
      description: optional status filter
      required: false
    ExecutionsStartDateFilter:
      in: query
      name: startDate
      schema:
        type: string
        format: date
      required: false
      description: startDate for filtering in ISO-8601 format, i.e. "yyyy-mm-dd"
    ExecutionsEndDateFilter:
      in: query
      name: endDate
      schema:
        type: string
        format: date
      required: false
      description: endDate for filtering
    Tags:
      in: query
      name: tags
      schema:
        type: array
        description: Tags to filter tests by
